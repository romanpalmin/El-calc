var PSEC={};PSEC.Calc=function(t,n,a){function e(){r()}function r(){var n="",a={login:t.person.login,homepage:t.person.homepage};dust.render("calculate-form.dust",a,function(a,e){n=e,$("#calculate-form").html(n),s=$(".b-elcalc-amount"),d=$(".b-elcalc-months"),v=$(".b-elcalc-percent"),g=$("#amount"),p=$("#period"),h=$("#percent"),E=[s,d,v,g,h,p],b=$(".b-elcalc-slider_amount"),f=$(".b-elcalc-slider_percent"),T=$(".b-elcalc-slider_period"),_=$(".b-elcalc-minus-btn_amount"),x=$(".b-elcalc-plus-btn_amount"),y=$(".b-elcalc-plus-btn_percent"),R=$(".b-elcalc-minus-btn_percent"),k=$(".b-elcalc-plus-btn_period"),F=$(".b-elcalc-minus-btn_period"),C=$(".b-result"),S=$(".b-result-summary");t.months,t.months;c(),u(),o(),l()})}function l(){p.val(I).trigger("input"),h.val(50).trigger("input"),g.val(25e3).trigger("input")}function u(){E.forEach(function(t){t.bind("change keyup input click",function(t){t.target.value.match(/[^0-9]/g)&&(t.target.value=this.value.replace(/[^0-9]/g,""))})}),p.on("input",function(n){n.currentTarget.value>t.period.max&&(n.currentTarget.value=t.period.max),n.currentTarget.value>=t.period.min&&n.currentTarget.value<=t.period.max?(T.slider("value",n.currentTarget.value),i()):console.log("Период некорректен.")}),g.on("input",function(n){n.currentTarget.value>t.amount.max&&(n.currentTarget.value=t.amount.max),n.currentTarget.value>=t.amount.min&&n.currentTarget.value<=t.amount.max?(b.slider("value",n.currentTarget.value),i()):console.log("Минимальная сумма вклада: 3000 Р")}),h.on("input",function(n){n.currentTarget.value>t.reinvest.max&&(n.currentTarget.value=t.reinvest.max),n.currentTarget.value>=t.reinvest.min&&n.currentTarget.value<=t.reinvest.max&&(f.slider("value",n.currentTarget.value),i())})}function o(){b.slider({min:t.amount.min,max:t.amount.max,orientation:"horizontal",range:"min",animate:!0,slide:function(t,n){g.val(n.value).trigger("input")}}),f.slider({min:t.reinvest.min,max:t.reinvest.max,orientation:"horizontal",range:"min",animate:!0,slide:function(t,n){h.val(n.value).trigger("input")}}),T.slider({min:t.period.min,max:t.period.max,orientation:"horizontal",range:"min",animate:!0,slide:function(t,n){p.val(n.value).trigger("input")}})}function i(){var t,a=g.val(),e=h.val(),r=p.val();t=n.Calculate(a,e,r,n.periodType.MONTH),C.html(m(t).htmlTable),S.html(m(t).htmlSummary)}function c(){_.on("click",function(){g.val(1*g.val()-1).trigger("input")}),x.on("click",function(){g.val(1*g.val()+1).trigger("input")}),F.on("click",function(){p.val(1*p.val()-1).trigger("input")}),k.on("click",function(){p.val(1*p.val()+1).trigger("input")}),R.on("click",function(){h.val(1*h.val()-1).trigger("input")}),y.on("click",function(){h.val(1*h.val()+1).trigger("input")})}function m(t){var n,e,r,l,u,o=t.summaryAmounts,i=[],c=['<table class="b-result-table">',"<thead> ","<th>Месяц</th>","<th>Взнос</th>","<th>Общий взнос</th>","<th>Доход со взноса</th>","<th>Реинвест</th>","<th> Вывод </th>","<th> Общий вывод</th>","</thead>","<tbody>"];return o.forEach(function(t){i=i.concat(['<tr class="b-result-table-row">',"<td>",a.Round(t.periodIterator+1),"</td>","<td>",a.FormatRound(t.amount),"</td>","<td>",a.FormatRound(t.totalAmount),"</td>","<td>",a.FormatRound(t.feeInPeriod),"</td>","<td>",a.FormatRound(t.reinvest),"</td>",'<td class="b-strong">',a.FormatRound(t.cash),"</td>","<td>",a.FormatRound(t.totalCash),"</td>","</tr>"])}),u=["</tbody></table>"],e=c.concat(i,u).join(""),l=['<h2 class="calc_choice_vklad_summ_title">','Сумма взносов на конец периода:  <span class="b-elcalc-summary_amount">',a.FormatRound(t.currentSumAmounts)," Р","</span><br>",'Сумма выплат на конец периода:  <span class="b-elcalc-summary_amount">',a.FormatRound(t.summaryCash)," Р","</span>"],l=t.restInBalance>0?l.concat(['<br>Остаток на балансе на конец периода: <span class="b-elcalc-summary_amount">',a.FormatRound(t.restInBalance)," Р","</span>"]):l.concat(["</h2>"]),r=l.join(""),n={htmlTable:e,htmlSummary:r}}var s,d,v,g,p,h,b,f,T,_,x,y,R,k,F,C,S,E=[],I=12;e()};