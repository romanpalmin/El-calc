var PSEC={};PSEC.Calc=function(t,a,n){function e(){r()}function r(){var a="",n={login:t.person.login,homepage:t.person.homepage};dust.render("calculate-form.dust",n,function(t,n){a=n,$("#calculate-form").html(a),s=$(".b-elcalc-amount"),d=$(".b-elcalc-months"),v=$(".b-elcalc-percent"),g=$("#amount"),p=$("#period"),h=$("#percent"),E=[s,d,v,g,h,p],b=$(".b-elcalc-slider_amount"),f=$(".b-elcalc-slider_percent"),T=$(".b-elcalc-slider_period"),_=$(".b-elcalc-minus-btn_amount"),x=$(".b-elcalc-plus-btn_amount"),y=$(".b-elcalc-plus-btn_percent"),R=$(".b-elcalc-minus-btn_percent"),k=$(".b-elcalc-plus-btn_period"),F=$(".b-elcalc-minus-btn_period"),C=$(".b-result"),S=$(".b-result-summary");i(),u(),c(),l()})}function l(){p.val(12).trigger("input"),h.val(50).trigger("input"),g.val(25e3).trigger("input")}function u(){E.forEach(function(t){t.bind("change keyup input click",function(t){t.target.value.match(/[^0-9]/g)&&(t.target.value=this.value.replace(/[^0-9]/g,""))})}),p.on("input",function(a){a.currentTarget.value>t.period.max&&(a.currentTarget.value=t.period.max),a.currentTarget.value>=t.period.min&&a.currentTarget.value<=t.period.max?(T.slider("value",a.currentTarget.value),o()):console.log("Период некорректен.")}),g.on("input",function(a){a.currentTarget.value>t.amount.max&&(a.currentTarget.value=t.amount.max),a.currentTarget.value>=t.amount.min&&a.currentTarget.value<=t.amount.max?(b.slider("value",a.currentTarget.value),o()):console.log("Минимальная сумма вклада: 3000 Р")}),h.on("input",function(a){a.currentTarget.value>t.reinvest.max&&(a.currentTarget.value=t.reinvest.max),a.currentTarget.value>=t.reinvest.min&&a.currentTarget.value<=t.reinvest.max&&(f.slider("value",a.currentTarget.value),o())})}function c(){b.slider({min:3e3,max:5e5,orientation:"horizontal",range:"min",animate:!0,slide:function(t,a){g.val(a.value).trigger("input")}}),f.slider({min:0,max:100,orientation:"horizontal",range:"min",animate:!0,slide:function(t,a){h.val(a.value).trigger("input")}}),T.slider({min:1,max:36,orientation:"horizontal",range:"min",animate:!0,slide:function(t,a){p.val(a.value).trigger("input")}})}function o(){var t,n=g.val(),e=h.val(),r=p.val();t=a.Calculate(n,e,r,a.periodType.MONTH),C.html(m(t).htmlTable),S.html(m(t).htmlSummary)}function i(){_.on("click",function(){g.val(1*g.val()-1).trigger("input")}),x.on("click",function(){g.val(1*g.val()+1).trigger("input")}),F.on("click",function(){p.val(1*p.val()-1).trigger("input")}),k.on("click",function(){p.val(1*p.val()+1).trigger("input")}),R.on("click",function(){h.val(1*h.val()-1).trigger("input")}),y.on("click",function(){h.val(1*h.val()+1).trigger("input")})}function m(t){var a,e,r,l,u,c=t.summaryAmounts,o=[],i=['<table class="b-result-table">',"<thead> ","<th>Месяц</th>","<th>Взнос</th>","<th>Общий взнос</th>","<th>Доход со взноса</th>","<th>Реинвест</th>","<th> Вывод </th>","<th> Общий вывод</th>","</thead>","<tbody>"];return c.forEach(function(t){o=o.concat(['<tr class="b-result-table-row">',"<td>",n.Round(t.periodIterator+1),"</td>","<td>",n.FormatRound(t.amount),"</td>","<td>",n.FormatRound(t.totalAmount),"</td>","<td>",n.FormatRound(t.feeInPeriod),"</td>","<td>",n.FormatRound(t.reinvest),"</td>",'<td class="b-strong">',n.FormatRound(t.cash),"</td>","<td>",n.FormatRound(t.totalCash),"</td>","</tr>"])}),u=["</tbody></table>"],e=i.concat(o,u).join(""),l=['<h2 class="calc_choice_vklad_summ_title">','Сумма взносов на конец периода:  <span class="b-elcalc-summary_amount">',n.FormatRound(t.currentSumAmounts)," Р","</span><br>",'Сумма выплат на конец периода:  <span class="b-elcalc-summary_amount">',n.FormatRound(t.summaryCash)," Р","</span>"],l=t.restInBalance>0?l.concat(['<br>Остаток на балансе на конец периода: <span class="b-elcalc-summary_amount">',n.FormatRound(t.restInBalance)," Р","</span>"]):l.concat(["</h2>"]),r=l.join(""),a={htmlTable:e,htmlSummary:r}}var s,d,v,g,p,h,b,f,T,_,x,y,R,k,F,C,S,E=[];e()};